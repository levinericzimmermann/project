{% set channel_count            = 4 %}
{% set midi_channel             = 1 %}
{% set midi_control_number_0    = 32 %}

{% set cello                    = "cello" %}
{% set harp                     = "harp" %}
{% set glockenspiel             = "glockenspiel" %}
{% set percussion               = "percussion" %}
{% set master                   = "master" %}
{% set audio_input_list         = [cello, percussion, glockenspile, harp] %}
{% set midi_control_input_list  = [master, cello, percussion, glockenspiel, harp] %}
{% set midi_range_instruments   = [-48, 12] %}
{% set midi_range_master        = [-48, 24] %}
{% set midi_range_list          = [midi_range_master, midi_range_instruments, midi_range_instruments, midi_range_instruments, midi_range_instruments] %}

[configure]
name                    = "10.3"
logging_level           = "info"

[configure.audio]
audio                   = "jack"
midi                    = "jack"
sampling_rate           = 44100
buffer_size             = 512
channel_count           = 4

{% for audio_input in audio_input_list %}

    {% set i = loop.index - 1 %}

    [configure.module.audio_input.{{ audio_input }}]
    input_channel_index = {{ i }}
    decibel             = "midi_control_input.{{ audio_input }}"

{% endfor %}

{% for midi_input in midi_control_input_list %}

    {% set i            = loop.index - 1 %}
    {% set midi_range   = midi_range_list[i] %}

    [configure.module.midi_control_input.{{ midi_input }}]
    midi_control_number = {{ midi_control_number_0 + i }}
    midi_channel        = {{ midi_channel }}

    [configure.module.midi_control_input.{{ midi_input }}.default_dict]
    minima              = {{ midi_range [0] }}
    maxima              = {{ midi_range [1] }}

{% endfor %}

[configure.module.diffusion.instruments]
input_channel_count                 = {{ audio_input_list | length }}
output_channel_count                = 3
# How much of the signal is constantly moving across the different speaker
pan_decibel                         = 0
# How much of the signal is always present on all speakers
base_decibel                        = -12
{% for audio_input in audio_input_list %}
    {% set i = loop.index - 1 %}
    audio_input_{{ i }}             = "audio_input.{{ audio_input }}"
{% endfor %}

[configure.module.mixer.pre_master]
audio_input_0                       = "diffusion.instruments"

[configure.module.mixer.pre_master.channel_mapping]
{% for audio_input in audio_input_list %}
    {% set i = loop.index - 1 %}
    {{ i }} = {{ i }}
{% endfor %}

# Map input to channel (without this all goes into the first channel)
[configure.module.mixer.pre_master.default_dict.audio_input_0_channel_mapping]
0 = [0]
1 = [1]
2 = [2]

[configure.module.mixer.master]
send_to_physical_output = true
decibel                 = "midi_control_input.{{ master }}"
audio_input_0           = "mixer.pre_master"

[configure.module.mixer.master.channel_mapping]
{% for channel_index in range(audio_input_list | length) %}
    {{ channel_index }} = {{ channel_index % channel_count }}
{% endfor %}
